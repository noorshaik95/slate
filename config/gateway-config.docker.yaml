server:
  host: "0.0.0.0"
  port: 8080

services:
  user-auth-service:
    name: "user-auth-service"
    endpoint: "http://user-auth-service:50051"
    timeout_ms: 5000
    connection_pool_size: 10
    auto_discover: true
    tls_enabled: false

  onboarding-service:
    name: "onboarding-service"
    endpoint: "http://onboarding-service:50052"
    timeout_ms: 30000  # Longer timeout for bulk operations
    connection_pool_size: 20
    auto_discover: true
    tls_enabled: false

discovery:
  enabled: true
  refresh_interval_seconds: 300

# Optional: Override specific routes when convention doesn't fit
route_overrides:
  - grpc_method: "user.UserService/Login"
    http_path: "/api/auth/login"
    http_method: "POST"
    service: "user-auth-service"
  
  - grpc_method: "user.UserService/Register"
    http_path: "/api/auth/register"
    http_method: "POST"
    service: "user-auth-service"
  
  - grpc_method: "user.UserService/RefreshToken"
    http_path: "/api/auth/refresh"
    http_method: "POST"
    service: "user-auth-service"
  
  - grpc_method: "user.UserService/ValidateToken"
    http_path: "/api/auth/validate"
    http_method: "POST"
    service: "user-auth-service"
  
  - grpc_method: "user.UserService/Logout"
    http_path: "/api/auth/logout"
    http_method: "POST"
    service: "user-auth-service"

  # Onboarding Service Routes (non-standard methods only - standard CRUD is auto-discovered)
  # Standard methods auto-discovered:
  #   CreateJob → POST /api/jobs
  #   GetJob → GET /api/jobs/:id
  #   ListJobs → GET /api/jobs
  #   GetTask → GET /api/tasks/:id
  #   ListTasks → GET /api/tasks

  - grpc_method: "onboarding.OnboardingService/CancelJob"
    http_path: "/api/jobs/:id/cancel"
    http_method: "POST"
    service: "onboarding-service"

  - grpc_method: "onboarding.OnboardingService/RetryJob"
    http_path: "/api/jobs/:id/retry"
    http_method: "POST"
    service: "onboarding-service"

  - grpc_method: "onboarding.OnboardingService/RetryTask"
    http_path: "/api/tasks/:id/retry"
    http_method: "POST"
    service: "onboarding-service"

  - grpc_method: "onboarding.OnboardingService/UploadCSV"
    http_path: "/api/onboarding/upload/csv"
    http_method: "POST"
    service: "onboarding-service"

  - grpc_method: "onboarding.OnboardingService/ProcessBatch"
    http_path: "/api/onboarding/batch"
    http_method: "POST"
    service: "onboarding-service"

  - grpc_method: "onboarding.OnboardingService/SyncIntegration"
    http_path: "/api/integrationconfigs/:id/sync"
    http_method: "POST"
    service: "onboarding-service"

  - grpc_method: "onboarding.OnboardingService/GetAuditLogs"
    http_path: "/api/auditlogs"
    http_method: "GET"
    service: "onboarding-service"

  - grpc_method: "onboarding.OnboardingService/ExportData"
    http_path: "/api/onboarding/export"
    http_method: "POST"
    service: "onboarding-service"

  - grpc_method: "onboarding.OnboardingService/Health"
    http_path: "/api/onboarding/health"
    http_method: "GET"
    service: "onboarding-service"

auth:
  service_endpoint: "http://user-auth-service:50051"
  timeout_ms: 3000
  public_routes:
    - path: "/api/auth/login"
      method: "POST"
    - path: "/api/auth/register"
      method: "POST"

rate_limit:
  enabled: true
  requests_per_minute: 100
  window_seconds: 60

observability:
  tempo_endpoint: "http://tempo:4317"
  service_name: "api-gateway"
