server:
  host: "0.0.0.0"
  port: 8080

services:
  user-auth-service:
    name: "user-auth-service"
    endpoint: "http://user-auth-service:50051"
    timeout_ms: 5000
    connection_pool_size: 10
    auto_discover: true
    tls_enabled: false

  assignment-grading-service:
    name: "assignment-grading-service"
    endpoint: "http://assignment-grading-service:50053"
    timeout_ms: 10000
    connection_pool_size: 10
    auto_discover: true
    tls_enabled: false

discovery:
  enabled: true
  refresh_interval_seconds: 300

# Optional: Override specific routes when convention doesn't fit
route_overrides:
  - grpc_method: "user.UserService/Login"
    http_path: "/api/auth/login"
    http_method: "POST"
    service: "user-auth-service"
  
  - grpc_method: "user.UserService/Register"
    http_path: "/api/auth/register"
    http_method: "POST"
    service: "user-auth-service"
  
  - grpc_method: "user.UserService/RefreshToken"
    http_path: "/api/auth/refresh"
    http_method: "POST"
    service: "user-auth-service"
  
  - grpc_method: "user.UserService/ValidateToken"
    http_path: "/api/auth/validate"
    http_method: "POST"
    service: "user-auth-service"
  
  - grpc_method: "user.UserService/Logout"
    http_path: "/api/auth/logout"
    http_method: "POST"
    service: "user-auth-service"

  # Assignment-Grading Service - Only non-conventional routes
  # Most routes auto-discovered (GetAssignment, CreateAssignment, etc.)

  # Custom: SubmitAssignment doesn't follow Get/List/Create/Update/Delete convention
  - grpc_method: "assignment.SubmissionService/SubmitAssignment"
    http_path: "/api/assignments/:assignment_id/submissions"
    http_method: "POST"
    service: "assignment-grading-service"

  # Custom: PublishGrade is a special action, not a standard CRUD operation
  - grpc_method: "assignment.GradingService/PublishGrade"
    http_path: "/api/grades/:id/publish"
    http_method: "POST"
    service: "assignment-grading-service"

  # Custom: Gradebook endpoints have specific resource hierarchies
  - grpc_method: "assignment.GradebookService/GetStudentGradebook"
    http_path: "/api/students/:student_id/gradebook"
    http_method: "GET"
    service: "assignment-grading-service"

  - grpc_method: "assignment.GradebookService/GetCourseGradebook"
    http_path: "/api/courses/:course_id/gradebook"
    http_method: "GET"
    service: "assignment-grading-service"

  - grpc_method: "assignment.GradebookService/GetGradeStatistics"
    http_path: "/api/assignments/:assignment_id/statistics"
    http_method: "GET"
    service: "assignment-grading-service"

  # Custom: ExportGrades is a special action
  - grpc_method: "assignment.GradebookService/ExportGrades"
    http_path: "/api/courses/:course_id/gradebook/export"
    http_method: "GET"
    service: "assignment-grading-service"

auth:
  service_endpoint: "http://user-auth-service:50051"
  timeout_ms: 3000
  public_routes:
    - path: "/api/auth/login"
      method: "POST"
    - path: "/api/auth/register"
      method: "POST"

rate_limit:
  enabled: true
  requests_per_minute: 100
  window_seconds: 60

observability:
  tempo_endpoint: "http://tempo:4317"
  service_name: "api-gateway"
