# Content Management Service Configuration
# Copy this file to .env and update with your values

# ============================================================================
# Server Configuration
# ============================================================================
SERVER__HOST=0.0.0.0
SERVER__PORT=8082
SERVER__GRPC_PORT=50052
SERVER__METRICS_PORT=9092
SERVER__SHUTDOWN_TIMEOUT_SECONDS=30

# ============================================================================
# Database Configuration (PostgreSQL)
# ============================================================================
DATABASE__URL=postgresql://cms:cms_password@localhost:5432/cms
DATABASE__MAX_CONNECTIONS=20
DATABASE__MIN_CONNECTIONS=5
DATABASE__CONNECTION_TIMEOUT_SECONDS=30
DATABASE__IDLE_TIMEOUT_SECONDS=600
DATABASE__MAX_LIFETIME_SECONDS=1800

# ============================================================================
# S3/MinIO Configuration
# ============================================================================
S3__ENDPOINT=http://localhost:9000
S3__ACCESS_KEY=minioadmin
S3__SECRET_KEY=minioadmin
S3__BUCKET=content-storage
S3__REGION=us-east-1
S3__USE_PATH_STYLE=true
S3__PRESIGNED_URL_EXPIRY_SECONDS=3600      # 1 hour for documents
S3__VIDEO_PRESIGNED_URL_EXPIRY_SECONDS=7200 # 2 hours for videos

# ============================================================================
# ElasticSearch Configuration
# ============================================================================
ELASTICSEARCH__URL=http://localhost:9200
ELASTICSEARCH__INDEX=content
ELASTICSEARCH__MAX_RETRIES=2
ELASTICSEARCH__TIMEOUT_SECONDS=30

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS__URL=redis://localhost:6379
REDIS__QUEUE_NAME=transcoding_jobs
REDIS__CONNECTION_TIMEOUT_SECONDS=5
REDIS__MAX_POOL_SIZE=10

# ============================================================================
# Observability Configuration
# ============================================================================
OBSERVABILITY__SERVICE_NAME=content-management-service
OBSERVABILITY__OTLP_ENDPOINT=http://localhost:4317
OBSERVABILITY__LOG_LEVEL=info
OBSERVABILITY__ENABLE_TRACING=true
OBSERVABILITY__ENABLE_METRICS=true
OBSERVABILITY__ENABLE_LOGGING=true

# ============================================================================
# Analytics Service Configuration
# ============================================================================
ANALYTICS__SERVICE_URL=http://localhost:50053
ANALYTICS__BATCH_SIZE=100
ANALYTICS__BATCH_INTERVAL_SECONDS=30
ANALYTICS__RETRY_INTERVAL_SECONDS=300  # 5 minutes
ANALYTICS__MAX_QUEUE_AGE_HOURS=24

# ============================================================================
# Upload Configuration
# ============================================================================
UPLOAD__MAX_FILE_SIZE_BYTES=524288000  # 500MB
UPLOAD__CHUNK_SIZE_BYTES=5242880       # 5MB
UPLOAD__SESSION_EXPIRY_HOURS=24
UPLOAD__ALLOWED_VIDEO_TYPES=video/mp4,video/quicktime,video/x-msvideo
UPLOAD__ALLOWED_DOCUMENT_TYPES=application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document
UPLOAD__ENABLE_MALWARE_SCAN=false

# ============================================================================
# Transcoding Configuration
# ============================================================================
TRANSCODING__WORKER_COUNT=2
TRANSCODING__MAX_RETRIES=3
TRANSCODING__SEGMENT_DURATION_SECONDS=6
TRANSCODING__OUTPUT_FORMATS=hls,dash

# Bitrate variants are configured in code or YAML config file
# Default variants: 360p (800kbps), 480p (1400kbps), 720p (2800kbps), 1080p (5000kbps)

# ============================================================================
# Optional: Config File Path
# ============================================================================
# CONFIG_FILE=config/content-management-service.yaml

# ============================================================================
# Rust Logging
# ============================================================================
RUST_LOG=info,content_management_service=debug
